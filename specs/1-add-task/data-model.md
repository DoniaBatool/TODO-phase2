# Data Model: Add Task Feature

**Feature**: F001 - Add Task  
**Status**: ✅ Implemented

## Entity Model

### Task Entity

The Task entity represents a single todo item in the system.

```python
@dataclass
class Task:
    id: int
    title: str
    description: str = ""
    completed: bool = False
    created_at: datetime = field(default_factory=datetime.now)
```

## Field Specifications

### id: int
**Purpose**: Unique identifier for the task

**Constraints**:
- Must be > 0
- Must be unique across all tasks
- Auto-generated by TaskManager
- Never reused (immutable)

**Generation**:
- Sequential starting from 1
- Increments on each task creation
- Managed by TaskManager.next_id

**Example Values**: 1, 2, 3, 4, ...

---

### title: str
**Purpose**: Short description of what needs to be done

**Constraints**:
- Length: 1-200 characters (after trimming)
- Cannot be empty or whitespace-only
- Leading/trailing whitespace automatically trimmed
- Required field

**Validation**:
```python
if not self.title or len(self.title.strip()) == 0:
    raise ValueError("Title cannot be empty")
if len(self.title) > 200:
    raise ValueError("Title too long (max 200 characters)")
self.title = self.title.strip()
```

**Example Values**:
- "Buy groceries"
- "Call dentist for appointment"
- "Review pull request #42"

---

### description: str
**Purpose**: Optional detailed information about the task

**Constraints**:
- Length: 0-1000 characters (after trimming)
- Can be empty string
- Leading/trailing whitespace automatically trimmed
- Optional field (defaults to "")

**Validation**:
```python
if len(self.description) > 1000:
    raise ValueError("Description too long (max 1000 characters)")
self.description = self.description.strip()
```

**Example Values**:
- "" (empty - no description)
- "Need milk, eggs, bread, and coffee"
- "Schedule cleaning and checkup. Preferred time: mornings."

---

### completed: bool
**Purpose**: Tracks whether task is done

**Constraints**:
- Must be boolean (True or False)
- Defaults to False for new tasks
- Can be toggled after creation (F004)

**States**:
- `False`: Task is pending/not done
- `True`: Task is completed

**Example Values**: False (for new tasks)

---

### created_at: datetime
**Purpose**: Timestamp when task was created

**Constraints**:
- Auto-generated at task creation
- Immutable (never changes)
- Uses system local time
- ISO 8601 compatible format

**Generation**:
```python
created_at: datetime = field(default_factory=datetime.now)
```

**Example Values**:
- `datetime(2025, 12, 9, 14, 30, 0)`
- Formatted: "2025-12-09 14:30:00"

## Data Flow

### Task Creation Flow

```
User Input (CLI)
    ↓
    title: str (raw)
    description: str (raw)
    ↓
TaskManager.add_task(title, description)
    ↓
Task.__init__(
    id=next_id,          ← Auto-generated
    title=title,         ← From user
    description=description,  ← From user
    completed=False,     ← Default
    created_at=now()     ← Auto-generated
)
    ↓
Task.__post_init__()     ← Validation
    ↓
    Trim whitespace
    Validate title (not empty, ≤ 200 chars)
    Validate description (≤ 1000 chars)
    ↓
    ✅ Valid Task object
    ↓
Append to TaskManager.tasks list
Increment TaskManager.next_id
    ↓
Return Task object to CLI
```

## Data Storage

### In-Memory Structure

```python
class TaskManager:
    tasks: List[Task]  # All tasks stored here
    next_id: int       # Next available ID
    
# Example state after adding 3 tasks:
manager.tasks = [
    Task(id=1, title="Buy groceries", description="", completed=False, ...),
    Task(id=2, title="Meeting", description="Discuss project", completed=False, ...),
    Task(id=3, title="Call dentist", description="", completed=False, ...)
]
manager.next_id = 4
```

**Storage Characteristics**:
- Python list (ordered, indexed)
- Tasks stored by reference
- No persistence (cleared on exit)
- Memory-only in Phase I

## Data Invariants

### Task Invariants
- `id` > 0
- `title` length ∈ [1, 200] after trimming
- `description` length ∈ [0, 1000] after trimming
- `completed` ∈ {True, False}
- `created_at` is valid datetime

### Manager Invariants
- All task IDs in `tasks` list are unique
- `next_id` > max(task.id for task in tasks)
- No two tasks have same ID
- Task order preserved (insertion order)

## Validation Rules

### Construction Validation (in Task.__post_init__)

| Rule | Check | Error Message |
|------|-------|---------------|
| Title required | `len(title.strip()) > 0` | "Title cannot be empty" |
| Title length | `len(title) ≤ 200` | "Title too long (max 200 characters)" |
| Description length | `len(description) ≤ 1000` | "Description too long (max 1000 characters)" |

### Input Sanitization

```python
# Before validation
title = title.strip()
description = description.strip()
```

**Trimming Examples**:
- "  Task  " → "Task"
- "\tTask\n" → "Task"
- "   " → "" (then fails validation if title)

## Serialization

### to_dict() Method

```python
def to_dict(self) -> dict:
    return {
        "id": self.id,
        "title": self.title,
        "description": self.description,
        "completed": self.completed,
        "created_at": self.created_at.isoformat()
    }
```

**Example Output**:
```json
{
    "id": 1,
    "title": "Buy groceries",
    "description": "Milk, eggs, bread",
    "completed": false,
    "created_at": "2025-12-09T14:30:00"
}
```

## String Representation

### __str__() Method

```python
def __str__(self) -> str:
    status = "✓" if self.completed else "○"
    return f"[{status}] {self.id}. {self.title}"
```

**Example Outputs**:
- `[○] 1. Buy groceries` (pending)
- `[✓] 2. Meeting` (completed)

## Future Considerations

**Phase II (Not Implemented)**:
- Database persistence (SQLModel)
- `updated_at` timestamp field
- User ID foreign key
- Additional validation constraints

**Phase III+ (Not Implemented)**:
- Priority field (high/medium/low)
- Tags/categories
- Due dates
- Recurrence rules

---

**Data Model Version**: 1.0  
**Created**: 2025-12-09  
**Status**: ✅ Implemented

